<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Docs, code and samples for my own Tanzu gym"><link href=https://matteo-magni.github.io/tanzugym/tkgm/workload-cluster/ rel=canonical><link href=../management-cluster/ rel=prev><link href=../ingress/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.1.3"><title>TKG workload cluster - The Tanzu Gym</title><link rel=stylesheet href=../../assets/stylesheets/main.c4a75a56.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.a0c5b2b5.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Metropolis,Avenir+Next,Helvetica+Neue,Arial,sans-serif:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Metropolis,Avenir Next,Helvetica Neue,Arial,sans-serif";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../assets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=light-blue data-md-color-accent=lime> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tkg-workload-cluster class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="The Tanzu Gym" class="md-header__button md-logo" aria-label="The Tanzu Gym" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13.95 13.5h-.23c-.18.11-.26.32-.18.5l.86 2.11c.83-.53 1.46-1.32 1.79-2.25l-2.23-.36h-.01m-3.45.29a.415.415 0 0 0-.38-.29h-.08l-2.22.37c.33.92.96 1.7 1.79 2.23l.85-2.07V14c.04-.05.04-.14.04-.21m1.83.81a.378.378 0 0 0-.51-.15c-.07.05-.12.08-.15.15h-.01l-1.09 1.97c.78.26 1.62.31 2.43.12.14-.03.29-.07.43-.12l-1.09-1.97h-.01m3.45-4.57L14.1 11.5l.01.03a.37.37 0 0 0-.04.53c.05.06.11.1.18.12l.01.01 2.17.62c.07-.97-.14-1.95-.65-2.78m-3.11.16c.01.21.18.37.39.36.08 0 .15-.02.21-.05h.01l1.83-1.31a4.45 4.45 0 0 0-2.57-1.24l.13 2.24m-1.94.31c.17.11.4.08.52-.09.05-.06.07-.13.08-.21h.01l.12-2.25c-.15.02-.3.05-.46.08-.8.18-1.54.58-2.12 1.16l1.84 1.31h.01m-.99 1.69c.2-.05.32-.26.26-.46 0-.08-.05-.14-.11-.19v-.01L8.21 10c-.52.86-.74 1.84-.63 2.82l2.16-.62v-.01m1.64.66.62.3.62-.3.15-.67-.43-.53h-.69l-.43.53.16.67m10.89 1.32L20.5 6.5c-.09-.42-.37-.76-.74-.94l-7.17-3.43c-.37-.17-.81-.17-1.19 0L4.24 5.56c-.37.18-.65.52-.74.94l-1.77 7.67c-.05.2-.05.4 0 .59.01.06.03.12.05.18.03.09.08.19.13.27.03.04.05.08.09.11l4.95 6.18c.02 0 .05.04.05.06.1.09.19.16.28.22.12.08.26.14.4.17.11.05.23.05.32.05h8.12c.07 0 .14-.03.2-.05.05-.01.1-.03.14-.04.04-.02.07-.03.11-.05.05-.02.1-.05.15-.08.12-.08.23-.18.33-.28l.15-.2 4.8-5.98c.1-.12.17-.25.22-.38.02-.06.04-.12.05-.18.05-.19.05-.4 0-.59m-7.43 2.99c.02.06.04.12.07.17-.04.08-.06.17-.03.26.12.24.23.46.38.68.08.11.16.23.24.34 0 .03.03.08.04.12.12.2.06.46-.15.59s-.47.05-.59-.15c-.01-.03-.02-.05-.03-.08-.02-.03-.04-.09-.06-.09-.05-.15-.09-.28-.12-.41-.09-.25-.17-.49-.3-.72a.375.375 0 0 0-.21-.14l-.08-.16c-1.29.48-2.7.48-3.97-.01l-.1.18c-.07.01-.14.04-.19.09-.14.24-.24.49-.33.77-.03.13-.07.26-.12.4-.02 0-.04.07-.06.1a.43.43 0 0 1-.81-.29c.01-.03.03-.05.04-.08.04-.03.04-.08.04-.11.09-.12.16-.23.24-.35.16-.21.29-.45.39-.69a.54.54 0 0 0-.03-.25l.07-.18a5.611 5.611 0 0 1-2.47-3.09l-.2.03a.388.388 0 0 0-.23-.09c-.27.05-.51.13-.77.22-.11.06-.24.11-.37.15-.03.01-.07.02-.13.03a.438.438 0 0 1-.54-.27c-.07-.23.04-.47.28-.55.02 0 .05-.01.08-.01v-.01h.01l.11-.02c.14-.04.28-.04.41-.04.26 0 .52-.06.77-.12.08-.05.14-.11.19-.19l.19-.05c-.21-1.36.1-2.73.86-3.87l-.14-.12c0-.09-.03-.18-.08-.25-.2-.17-.41-.32-.64-.45-.12-.06-.24-.13-.36-.21-.02-.02-.06-.05-.08-.07l-.01-.01c-.2-.16-.25-.42-.11-.63.09-.1.21-.15.35-.15.11.01.21.05.3.12l.09.07c.1.09.19.2.28.3.18.19.37.37.58.52.08.04.17.05.26.03l.15.11c.75-.8 1.73-1.36 2.8-1.6.25-.06.52-.1.78-.12l.01-.18a.45.45 0 0 0 .14-.23c.01-.26-.01-.52-.05-.77-.03-.13-.05-.27-.06-.41V5.1c-.02-.24.15-.45.39-.48s.44.15.47.38v.22c-.01.14-.03.28-.06.41-.04.25-.06.51-.05.77.02.1.07.17.14.22l.01.19c1.36.12 2.62.73 3.56 1.72l.16-.12c.09.02.18.01.26-.03.21-.15.41-.33.58-.52.09-.1.18-.2.28-.3.03-.02.07-.06.1-.06.17-.18.44-.18.59 0 .19.16.18.43 0 .6 0 .02-.03.04-.06.06a2.495 2.495 0 0 1-.44.28c-.23.13-.45.28-.64.45-.06.07-.09.15-.08.24l-.16.14a5.44 5.44 0 0 1 .88 3.86l.19.05c.04.08.11.14.19.18.25.07.51.11.77.14h.41c.03.03.08.04.12.05.24.03.4.25.37.49-.05.23-.24.4-.48.37-.03-.01-.07-.01-.07-.02v-.01c-.06 0-.1-.01-.14-.02-.13-.04-.25-.09-.36-.15-.26-.1-.5-.17-.77-.21-.09 0-.17 0-.23.08-.07-.01-.13-.02-.19-.03-.41 1.31-1.31 2.41-2.47 3.11Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> The Tanzu Gym </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> TKG workload cluster </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=light-blue data-md-color-accent=lime aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=teal data-md-color-accent=lime aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/matteo-magni/tanzugym title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> matteo-magni/tanzugym </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> HOME </a> </li> <li class=md-tabs__item> <a href=../ class="md-tabs__link md-tabs__link--active"> Tanzu Kubernetes Grid </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="The Tanzu Gym" class="md-nav__button md-logo" aria-label="The Tanzu Gym" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13.95 13.5h-.23c-.18.11-.26.32-.18.5l.86 2.11c.83-.53 1.46-1.32 1.79-2.25l-2.23-.36h-.01m-3.45.29a.415.415 0 0 0-.38-.29h-.08l-2.22.37c.33.92.96 1.7 1.79 2.23l.85-2.07V14c.04-.05.04-.14.04-.21m1.83.81a.378.378 0 0 0-.51-.15c-.07.05-.12.08-.15.15h-.01l-1.09 1.97c.78.26 1.62.31 2.43.12.14-.03.29-.07.43-.12l-1.09-1.97h-.01m3.45-4.57L14.1 11.5l.01.03a.37.37 0 0 0-.04.53c.05.06.11.1.18.12l.01.01 2.17.62c.07-.97-.14-1.95-.65-2.78m-3.11.16c.01.21.18.37.39.36.08 0 .15-.02.21-.05h.01l1.83-1.31a4.45 4.45 0 0 0-2.57-1.24l.13 2.24m-1.94.31c.17.11.4.08.52-.09.05-.06.07-.13.08-.21h.01l.12-2.25c-.15.02-.3.05-.46.08-.8.18-1.54.58-2.12 1.16l1.84 1.31h.01m-.99 1.69c.2-.05.32-.26.26-.46 0-.08-.05-.14-.11-.19v-.01L8.21 10c-.52.86-.74 1.84-.63 2.82l2.16-.62v-.01m1.64.66.62.3.62-.3.15-.67-.43-.53h-.69l-.43.53.16.67m10.89 1.32L20.5 6.5c-.09-.42-.37-.76-.74-.94l-7.17-3.43c-.37-.17-.81-.17-1.19 0L4.24 5.56c-.37.18-.65.52-.74.94l-1.77 7.67c-.05.2-.05.4 0 .59.01.06.03.12.05.18.03.09.08.19.13.27.03.04.05.08.09.11l4.95 6.18c.02 0 .05.04.05.06.1.09.19.16.28.22.12.08.26.14.4.17.11.05.23.05.32.05h8.12c.07 0 .14-.03.2-.05.05-.01.1-.03.14-.04.04-.02.07-.03.11-.05.05-.02.1-.05.15-.08.12-.08.23-.18.33-.28l.15-.2 4.8-5.98c.1-.12.17-.25.22-.38.02-.06.04-.12.05-.18.05-.19.05-.4 0-.59m-7.43 2.99c.02.06.04.12.07.17-.04.08-.06.17-.03.26.12.24.23.46.38.68.08.11.16.23.24.34 0 .03.03.08.04.12.12.2.06.46-.15.59s-.47.05-.59-.15c-.01-.03-.02-.05-.03-.08-.02-.03-.04-.09-.06-.09-.05-.15-.09-.28-.12-.41-.09-.25-.17-.49-.3-.72a.375.375 0 0 0-.21-.14l-.08-.16c-1.29.48-2.7.48-3.97-.01l-.1.18c-.07.01-.14.04-.19.09-.14.24-.24.49-.33.77-.03.13-.07.26-.12.4-.02 0-.04.07-.06.1a.43.43 0 0 1-.81-.29c.01-.03.03-.05.04-.08.04-.03.04-.08.04-.11.09-.12.16-.23.24-.35.16-.21.29-.45.39-.69a.54.54 0 0 0-.03-.25l.07-.18a5.611 5.611 0 0 1-2.47-3.09l-.2.03a.388.388 0 0 0-.23-.09c-.27.05-.51.13-.77.22-.11.06-.24.11-.37.15-.03.01-.07.02-.13.03a.438.438 0 0 1-.54-.27c-.07-.23.04-.47.28-.55.02 0 .05-.01.08-.01v-.01h.01l.11-.02c.14-.04.28-.04.41-.04.26 0 .52-.06.77-.12.08-.05.14-.11.19-.19l.19-.05c-.21-1.36.1-2.73.86-3.87l-.14-.12c0-.09-.03-.18-.08-.25-.2-.17-.41-.32-.64-.45-.12-.06-.24-.13-.36-.21-.02-.02-.06-.05-.08-.07l-.01-.01c-.2-.16-.25-.42-.11-.63.09-.1.21-.15.35-.15.11.01.21.05.3.12l.09.07c.1.09.19.2.28.3.18.19.37.37.58.52.08.04.17.05.26.03l.15.11c.75-.8 1.73-1.36 2.8-1.6.25-.06.52-.1.78-.12l.01-.18a.45.45 0 0 0 .14-.23c.01-.26-.01-.52-.05-.77-.03-.13-.05-.27-.06-.41V5.1c-.02-.24.15-.45.39-.48s.44.15.47.38v.22c-.01.14-.03.28-.06.41-.04.25-.06.51-.05.77.02.1.07.17.14.22l.01.19c1.36.12 2.62.73 3.56 1.72l.16-.12c.09.02.18.01.26-.03.21-.15.41-.33.58-.52.09-.1.18-.2.28-.3.03-.02.07-.06.1-.06.17-.18.44-.18.59 0 .19.16.18.43 0 .6 0 .02-.03.04-.06.06a2.495 2.495 0 0 1-.44.28c-.23.13-.45.28-.64.45-.06.07-.09.15-.08.24l-.16.14a5.44 5.44 0 0 1 .88 3.86l.19.05c.04.08.11.14.19.18.25.07.51.11.77.14h.41c.03.03.08.04.12.05.24.03.4.25.37.49-.05.23-.24.4-.48.37-.03-.01-.07-.01-.07-.02v-.01c-.06 0-.1-.01-.14-.02-.13-.04-.25-.09-.36-.15-.26-.1-.5-.17-.77-.21-.09 0-.17 0-.23.08-.07-.01-.13-.02-.19-.03-.41 1.31-1.31 2.41-2.47 3.11Z"/></svg> </a> The Tanzu Gym </label> <div class=md-nav__source> <a href=https://github.com/matteo-magni/tanzugym title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> matteo-magni/tanzugym </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> HOME </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> Tanzu Kubernetes Grid <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Tanzu Kubernetes Grid </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> Preface </a> </li> <li class=md-nav__item> <a href=../bastion/ class=md-nav__link> Prepare bastion host </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> Internal registry <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Internal registry </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../registry/ class=md-nav__link> Deployment and configuration </a> </li> <li class=md-nav__item> <a href=../relocate-images/ class=md-nav__link> Relocate TKG images </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../management-cluster/ class=md-nav__link> TKG management cluster </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> TKG workload cluster <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> TKG workload cluster </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prepare-workload-cluster-definition class=md-nav__link> Prepare workload cluster definition </a> </li> <li class=md-nav__item> <a href=#create-workload-cluster class=md-nav__link> Create workload cluster </a> </li> <li class=md-nav__item> <a href=#connect-to-the-new-cluster class=md-nav__link> Connect to the new cluster </a> </li> <li class=md-nav__item> <a href=#configure-tanzu-standard-repository class=md-nav__link> Configure Tanzu standard repository </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../ingress/ class=md-nav__link> Ingress controller </a> </li> <li class=md-nav__item> <a href=../identity-management/ class=md-nav__link> Identity management </a> </li> <li class=md-nav__item> <a href=../troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#prepare-workload-cluster-definition class=md-nav__link> Prepare workload cluster definition </a> </li> <li class=md-nav__item> <a href=#create-workload-cluster class=md-nav__link> Create workload cluster </a> </li> <li class=md-nav__item> <a href=#connect-to-the-new-cluster class=md-nav__link> Connect to the new cluster </a> </li> <li class=md-nav__item> <a href=#configure-tanzu-standard-repository class=md-nav__link> Configure Tanzu standard repository </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=tkg-workload-cluster>TKG workload cluster<a class=headerlink href=#tkg-workload-cluster title="Permanent link">&para;</a></h1> <div class="admonition info"> <p class=admonition-title>Info</p> <p>The official VMware documentation is available at <a href=https://docs.vmware.com/en/VMware-Tanzu-Kubernetes-Grid/2.1/using-tkg-21/workload-index.html>https://docs.vmware.com/en/VMware-Tanzu-Kubernetes-Grid/2.1/using-tkg-21/workload-index.html</a>.</p> </div> <p>Tanzu Kubernetes Grid workload clusters are the Kubernetes clusters responsible for running your applications, and can be created using the Tanzu CLI from a TKG management cluster on the same platform (i.e. vSphere).</p> <p>You can create three types of workload clusters:</p> <ul> <li>Class-based clusters (default)</li> <li>Plan-based clusters (legacy)</li> <li>TKC-based clusters (legacy)</li> </ul> <p>More information about the different classes are available on <a href=https://docs.vmware.com/en/VMware-Tanzu-Kubernetes-Grid/2/about-tkg/clusters.html#types>VMware docs website</a>. This guide explains how to create class-based clusters.</p> <h2 id=prepare-workload-cluster-definition>Prepare workload cluster definition<a class=headerlink href=#prepare-workload-cluster-definition title="Permanent link">&para;</a></h2> <p>The class-based workflow cluster manifest can be created from a flat file, similar to the one used for building the management cluster. Following <a href=https://docs.vmware.com/en/VMware-Tanzu-Kubernetes-Grid/2.1/using-tkg-21/workload-clusters-configure-vsphere.html>VMware docs</a>, you can create the flat configuration file, for example:</p> <div class=highlight><pre><span></span><code><span class=nt>AVI_CONTROL_PLANE_HA_PROVIDER</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=nt>CLUSTER_ANNOTATIONS</span><span class=p>:</span><span class=w> </span><span class=s>&#39;description:alpha-workload-cluster,location:non,mc:t1xl&#39;</span>
<span class=nt>CLUSTER_CIDR</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100.96.0.0/11</span>
<span class=nt>SERVICE_CIDR</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100.64.0.0/13</span>
<span class=nt>CLUSTER_PLAN</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">dev</span>
<span class=nt>NAMESPACE</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class=nt>CNI</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">antrea</span>
<span class=nt>ENABLE_AUDIT_LOGGING</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=nt>ENABLE_CEIP_PARTICIPATION</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=nt>ENABLE_MHC</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=nt>ENABLE_MHC_CONTROL_PLANE</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=nt>ENABLE_MHC_WORKER_NODE</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=nt>MHC_UNKNOWN_STATUS_TIMEOUT</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5m</span>
<span class=nt>MHC_FALSE_STATUS_TIMEOUT</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">12m</span>
<span class=nt>IDENTITY_MANAGEMENT_TYPE</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">none</span>
<span class=nt>INFRASTRUCTURE_PROVIDER</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">vsphere</span>
<span class=nt>OS_ARCH</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">amd64</span>
<span class=nt>OS_NAME</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">photon</span>
<span class=nt>OS_VERSION</span><span class=p>:</span><span class=w> </span><span class=s>&quot;3&quot;</span>
<span class=nt>TKG_HTTP_PROXY_ENABLED</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=nt>VSPHERE_CONTROL_PLANE_ENDPOINT</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my.endpoint.fqdn.or.ip</span>
<span class=nt>VSPHERE_DATACENTER</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/vc01</span>
<span class=nt>VSPHERE_DATASTORE</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/vc01/datastore/vsanDatastore</span>
<span class=nt>VSPHERE_FOLDER</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/vc01/vm/tkgm/alpha</span>
<span class=nt>VSPHERE_INSECURE</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=nt>VSPHERE_NETWORK</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/vc01/network/tkgm_vip_workload</span>
<span class=nt>VSPHERE_PASSWORD</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;encoded:bXktb3duLXBhc3N3b3JkCg==&gt;</span>
<span class=nt>VSPHERE_RESOURCE_POOL</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/vc01/host/vc01cl01/Resources</span>
<span class=nt>VSPHERE_SERVER</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">my.vcenter.fqdn.or.ip</span>
<span class=nt>VSPHERE_SSH_AUTHORIZED_KEY</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICAKfCTddh2+U/Y3DmhTwq9pqr+bWCZFxEOF1S2LVxsR</span>
<span class=nt>VSPHERE_TLS_THUMBPRINT</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">B6:C1:C2:77:2F:E5:BA:C7:C1:C3:AD:59:E1:76:E4:19:13:75:30:ED</span>
<span class=nt>VSPHERE_USERNAME</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">administrator@vsphere.local</span>
</code></pre></div> <p>You can also use a different user with fewer privileges than <code>administrator@vsphere.local</code> for building the workload cluster, more info on this will be provided in a different section. All settings are detailed in the <a href=https://docs.vmware.com/en/VMware-Tanzu-Kubernetes-Grid/2.1/tkg-deploy-mc-21/mgmt-deploy-file.html>VMware docs website</a>.</p> <p>You can get the vCenter SHA1 fingerprint (for the <code>VSPHERE_TLS_THUMBPRINT</code> setting) as</p> <div class=highlight><pre><span></span><code>openssl<span class=w> </span>s_client<span class=w> </span>-connect<span class=w> </span>my.vcenter.fqdn.or.ip:443<span class=w> </span>-servername<span class=w> </span>my.vcenter.fqdn.or.ip<span class=w> </span>-showcerts<span class=w> </span>&lt;/dev/null<span class=w> </span><span class=m>2</span>&gt;/dev/null<span class=w> </span><span class=p>|</span><span class=w> </span>openssl<span class=w> </span>x509<span class=w> </span>-fingerprint<span class=w> </span>-noout<span class=w> </span>-sha1<span class=w> </span><span class=p>|</span><span class=w> </span>cut<span class=w> </span>-d<span class=o>=</span><span class=w> </span>-f2
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The <code>-sha1</code> flag is necessary especially on MacOS's openssl, where the default output digest is md5.</p> </div> <p>You may now convert the flat file to the class-based file. First of all, set the Tanzu CLI to not apply automatically the generated class-based file:</p> <div class=highlight><pre><span></span><code>tanzu<span class=w> </span>config<span class=w> </span><span class=nb>set</span><span class=w> </span>features.cluster.auto-apply-generated-clusterclass-based-configuration<span class=w> </span><span class=nb>false</span>
</code></pre></div> <p>then you can produce such file as</p> <div class=highlight><pre><span></span><code>tanzu<span class=w> </span>cluster<span class=w> </span>create<span class=w> </span>alpha<span class=w> </span>--file<span class=w> </span>alpha-config.yaml<span class=w> </span>--dry-run<span class=w> </span>&gt;<span class=w> </span>alpha-spec.yaml
</code></pre></div> <p>This command takes also care of validating your inputs, therefore if something is not right (i.e. the designated vSphere folder does not exist) it will fail with a meaningful message.</p> <p>The generated YAML file defines these resource types:</p> <ul> <li><code>VSphereCPIConfig</code></li> <li><code>VSphereCSIConfig</code></li> <li><code>ClusterBootstrap</code></li> <li><code>Secret</code></li> <li><code>Cluster</code></li> </ul> <p>The <code>ClusterBootstrap</code> defines which components will be deployed to the new cluster as Tanzu packages. One thing to notice is that those components do not include the version, but they rather specify <code>*</code></p> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">run.tanzu.vmware.com/v1alpha3</span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ClusterBootstrap</span>
<span class=nt>metadata</span><span class=p>:</span>
<span class=w>  </span><span class=nt>annotations</span><span class=p>:</span>
<span class=w>    </span><span class=nt>tkg.tanzu.vmware.com/add-missing-fields-from-tkr</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1.24.9---vmware.1-tkg.1</span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">alpha</span>
<span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class=nt>spec</span><span class=p>:</span>
<span class=w>  </span><span class=nt>additionalPackages</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>refName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">metrics-server*</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>refName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">secretgen-controller*</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>refName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pinniped*</span>
<span class=w>  </span><span class=nt>cpi</span><span class=p>:</span>
<span class=w>    </span><span class=nt>refName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">vsphere-cpi*</span>
<span class=w>    </span><span class=nt>valuesFrom</span><span class=p>:</span>
<span class=w>      </span><span class=nt>providerRef</span><span class=p>:</span>
<span class=w>        </span><span class=nt>apiGroup</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cpi.tanzu.vmware.com</span>
<span class=w>        </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">VSphereCPIConfig</span>
<span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">alpha</span>
<span class=w>  </span><span class=nt>csi</span><span class=p>:</span>
<span class=w>    </span><span class=nt>refName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">vsphere-csi*</span>
<span class=w>    </span><span class=nt>valuesFrom</span><span class=p>:</span>
<span class=w>      </span><span class=nt>providerRef</span><span class=p>:</span>
<span class=w>        </span><span class=nt>apiGroup</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">csi.tanzu.vmware.com</span>
<span class=w>        </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">VSphereCSIConfig</span>
<span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">alpha</span>
<span class=w>  </span><span class=nt>kapp</span><span class=p>:</span>
<span class=w>    </span><span class=nt>refName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kapp-controller*</span>
</code></pre></div> <p>to include any possible version that may have been made available to the cluster via a Tanzu package repository.</p> <p>The downside is that this resource cannot be used as a desired state and thus included into a GitOps-like process, as those <code>*</code>s are immediately translated into actual versions as soon as the workload cluster gets created.</p> <h2 id=create-workload-cluster>Create workload cluster<a class=headerlink href=#create-workload-cluster title="Permanent link">&para;</a></h2> <p>You now have the YAML manifest for the new cluster, which must be applied to the management cluster.</p> <p>Make sure you do have your management cluster configuration and set it as your default kubeconfig file. You should be able to find it at <code>~/.kube-tkg/config</code>, so you just have to set</p> <div class=highlight><pre><span></span><code><span class=nb>export</span><span class=w> </span><span class=nv>KUBECONFIG</span><span class=o>=</span>~/.kube-tkg/config
</code></pre></div> <p>and you can check you're connected to the right endpoint via</p> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>get<span class=w> </span>nodes
</code></pre></div> <p>You can also retrieve the kubeconfig file via</p> <div class=highlight><pre><span></span><code>tanzu<span class=w> </span>mc<span class=w> </span>kubeconfig<span class=w> </span>get<span class=w> </span>--admin
</code></pre></div> <p>and switch to the right context. Now apply the workload cluster manifest:</p> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>apply<span class=w> </span>-f<span class=w> </span>alpha-spec.yaml
</code></pre></div> <p>You can monitor the status of the resources running a <code>kubectl get</code> wrapped in a <code>watch</code>:</p> <div class=highlight><pre><span></span><code>watch<span class=w> </span>kubectl<span class=w> </span>get<span class=w> </span>md,ma,vspherevm,vspheremachines
</code></pre></div> <p>and</p> <div class=highlight><pre><span></span><code>❯<span class=w> </span>tanzu<span class=w> </span>cluster<span class=w> </span>list

<span class=w>  </span>NAME<span class=w>   </span>NAMESPACE<span class=w>  </span>STATUS<span class=w>   </span>CONTROLPLANE<span class=w>  </span>WORKERS<span class=w>  </span>KUBERNETES<span class=w>        </span>ROLES<span class=w>   </span>PLAN<span class=w>  </span>TKR
<span class=w>  </span>alpha<span class=w>  </span>default<span class=w>    </span>running<span class=w>  </span><span class=m>1</span>/1<span class=w>           </span><span class=m>2</span>/2<span class=w>      </span>v1.24.9+vmware.1<span class=w>  </span>&lt;none&gt;<span class=w>  </span>dev<span class=w>   </span>v1.24.9---vmware.1-tkg.1
</code></pre></div> <h2 id=connect-to-the-new-cluster>Connect to the new cluster<a class=headerlink href=#connect-to-the-new-cluster title="Permanent link">&para;</a></h2> <p>Ask the Tanzu CLI to fetch the kubeconfig file for you and store it to a file. To get the configuration added to the currently active kubeconfig file you must omit the <code>--export-file</code> flag:</p> <div class=highlight><pre><span></span><code>❯<span class=w> </span>tanzu<span class=w> </span>cluster<span class=w> </span>kubeconfig<span class=w> </span>get<span class=w> </span>alpha<span class=w> </span>--admin<span class=w> </span>--export-file<span class=w> </span>alpha.kubeconfig

Credentials<span class=w> </span>of<span class=w> </span>cluster<span class=w> </span><span class=s1>&#39;alpha&#39;</span><span class=w> </span>have<span class=w> </span>been<span class=w> </span>saved
You<span class=w> </span>can<span class=w> </span>now<span class=w> </span>access<span class=w> </span>the<span class=w> </span>cluster<span class=w> </span>by<span class=w> </span>running<span class=w> </span><span class=s1>&#39;kubectl config use-context alpha-admin@alpha&#39;</span><span class=w> </span>under<span class=w> </span>path<span class=w> </span><span class=s1>&#39;alpha.kubeconfig&#39;</span>
</code></pre></div> <p>Check the nodes status</p> <div class=highlight><pre><span></span><code>❯<span class=w> </span><span class=nb>export</span><span class=w> </span><span class=nv>KUBECONFIG</span><span class=o>=</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>/alpha.kubeconfig
❯<span class=w> </span>kubectl<span class=w> </span>get<span class=w> </span>nodes
NAME<span class=w>                                </span>STATUS<span class=w>   </span>ROLES<span class=w>           </span>AGE<span class=w>     </span>VERSION
alpha-md-0-9qpjk-8694659b79-7mpxs<span class=w>   </span>Ready<span class=w>    </span>&lt;none&gt;<span class=w>          </span>91s<span class=w>     </span>v1.24.9+vmware.1
alpha-md-0-9qpjk-8694659b79-vfrbk<span class=w>   </span>Ready<span class=w>    </span>&lt;none&gt;<span class=w>          </span>89s<span class=w>     </span>v1.24.9+vmware.1
alpha-rv6pp-fkqg4<span class=w>                   </span>Ready<span class=w>    </span>control-plane<span class=w>   </span>2m28s<span class=w>   </span>v1.24.9+vmware.1
</code></pre></div> <p>You can now test the cluster with a sample nginx web server. As this environment is isolated, you need to push the image to the internal registry first (this step might be documented elsewhere in the future), and then you can run it. In this example, I created an <code>apps</code> project on the registry and pushed a <code>nginx:stable-alpine</code> to it.</p> <div class=highlight><pre><span></span><code>kubectl<span class=w> </span>run<span class=w> </span>--image<span class=w> </span>registry.my.domain/apps/nginx:stable-alpine<span class=w> </span>nginx
kubectl<span class=w> </span>port-forward<span class=w> </span>pods/nginx<span class=w> </span><span class=m>8080</span>:80
</code></pre></div> <p>and, in another terminal,</p> <div class=highlight><pre><span></span><code>curl<span class=w> </span>localhost:8080
</code></pre></div> <p>the response confirms the pod is running correctly.</p> <div class=highlight><pre><span></span><code><span class=cp>&lt;!DOCTYPE html&gt;</span>
<span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Welcome to nginx!<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
<span class=nt>html</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>color-scheme</span><span class=p>:</span><span class=w> </span><span class=n>light</span><span class=w> </span><span class=n>dark</span><span class=p>;</span><span class=w> </span><span class=p>}</span>
<span class=nt>body</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>width</span><span class=p>:</span><span class=w> </span><span class=mi>35</span><span class=kt>em</span><span class=p>;</span><span class=w> </span><span class=k>margin</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=kc>auto</span><span class=p>;</span>
<span class=k>font-family</span><span class=p>:</span><span class=w> </span><span class=n>Tahoma</span><span class=p>,</span><span class=w> </span><span class=n>Verdana</span><span class=p>,</span><span class=w> </span><span class=n>Arial</span><span class=p>,</span><span class=w> </span><span class=kc>sans-serif</span><span class=p>;</span><span class=w> </span><span class=p>}</span>
<span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>Welcome to nginx!<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>For online documentation and support please refer to
<span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&quot;http://nginx.org/&quot;</span><span class=p>&gt;</span>nginx.org<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>.<span class=p>&lt;</span><span class=nt>br</span><span class=p>/&gt;</span>
Commercial support is available at
<span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&quot;http://nginx.com/&quot;</span><span class=p>&gt;</span>nginx.com<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>.<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;&lt;</span><span class=nt>em</span><span class=p>&gt;</span>Thank you for using nginx.<span class=p>&lt;/</span><span class=nt>em</span><span class=p>&gt;&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</code></pre></div> <h2 id=configure-tanzu-standard-repository>Configure Tanzu standard repository<a class=headerlink href=#configure-tanzu-standard-repository title="Permanent link">&para;</a></h2> <p>TKG provides a number of packages available to be installed and used right out of the box, based on the Carvel kapp packaging system. They are delivered as part of a kapp repository, which is also available as OCI image, thats has been relocated in the internal registry during <a href=../relocate-images/ >image relocation</a>.</p> <p>You can add the repository as</p> <div class=highlight><pre><span></span><code>tanzu<span class=w> </span>package<span class=w> </span>repository<span class=w> </span>add<span class=w> </span>tanzu-standard<span class=w> </span>--url<span class=w> </span><span class=si>${</span><span class=nv>TKG_CUSTOM_IMAGE_REPOSITORY</span><span class=si>}</span>/packages/standard/repo:v2.1.0<span class=w> </span>--namespace<span class=w> </span>tkg-system
</code></pre></div> <p>and, as soon as the reconciliation succeeds, you can list available packages:</p> <div class=highlight><pre><span></span><code>❯<span class=w> </span>tanzu<span class=w> </span>package<span class=w> </span>available<span class=w> </span>list

<span class=w>  </span>NAME<span class=w>                                          </span>DISPLAY-NAME
<span class=w>  </span>cert-manager.tanzu.vmware.com<span class=w>                 </span>cert-manager
<span class=w>  </span>contour.tanzu.vmware.com<span class=w>                      </span>contour
<span class=w>  </span>external-dns.tanzu.vmware.com<span class=w>                 </span>external-dns
<span class=w>  </span>fluent-bit.tanzu.vmware.com<span class=w>                   </span>fluent-bit
<span class=w>  </span>fluxcd-helm-controller.tanzu.vmware.com<span class=w>       </span>Flux<span class=w> </span>Helm<span class=w> </span>Controller
<span class=w>  </span>fluxcd-kustomize-controller.tanzu.vmware.com<span class=w>  </span>Flux<span class=w> </span>Kustomize<span class=w> </span>Controller
<span class=w>  </span>fluxcd-source-controller.tanzu.vmware.com<span class=w>     </span>Flux<span class=w> </span>Source<span class=w> </span>Controller
<span class=w>  </span>grafana.tanzu.vmware.com<span class=w>                      </span>grafana
<span class=w>  </span>harbor.tanzu.vmware.com<span class=w>                       </span>harbor
<span class=w>  </span>multus-cni.tanzu.vmware.com<span class=w>                   </span>multus-cni
<span class=w>  </span>prometheus.tanzu.vmware.com<span class=w>                   </span>prometheus
<span class=w>  </span>whereabouts.tanzu.vmware.com<span class=w>                  </span>whereabouts
</code></pre></div> <p>The packages are available in all namespaces, as the repository has been installed in kapp-controller's packaging global namespace.</p> <hr> <div class=md-source-file> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2023-03-03 17:30:18</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2023 Matteo Magni </div> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.tabs.sticky", "content.code.annotate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.efa0ade1.min.js></script> </body> </html>